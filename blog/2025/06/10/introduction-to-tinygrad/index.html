
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="I'm a Software Engineer with a strong background in Artificial Intelligence (AI) and Machine Learning (ML) who loves turning complex ideas into practical solutions. I've worked as an AI Engineer, Developer Relations Engineer, and freelance content creator, crafting engaging AI-focused content. I've helped build AI-powered products such as Kilo Code (an autonomous coding agent), Emergent Mind (a RAG system for CS research), and a range of scalable web applications for early-stage startups.">
      
      
        <meta name="author" content="Omar Olivares Urrutia">
      
      
        <link rel="canonical" href="https://olivares.cl/blog/2025/06/10/introduction-to-tinygrad/">
      
      
        <link rel="prev" href="../../../01/01/things-you-should-be-reading-about-ai-in-2025/">
      
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../../../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../../../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../../../../favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>Introduction to Tinygrad - Omar Olivares Urrutia</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=ML+Modern:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"ML Modern";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../css/timeago.css">
    
      <link rel="stylesheet" href="../../../../../static/style.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-6MR2H8YX5K"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-6MR2H8YX5K",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-6MR2H8YX5K",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction-to-tinygrad" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="Omar Olivares Urrutia" class="md-header__button md-logo" aria-label="Omar Olivares Urrutia" data-md-component="logo">
      
  <img src="../../../../../static/images/profile.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Omar Olivares Urrutia
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Introduction to Tinygrad
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="red"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ofou/ofou.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    olivares.cl
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../../" class="md-tabs__link">
          
  
  
    
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../projects/graham/" class="md-tabs__link">
          
  
  
    
  
  Projects

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="Omar Olivares Urrutia" class="md-nav__button md-logo" aria-label="Omar Olivares Urrutia" data-md-component="logo">
      
  <img src="../../../../../static/images/profile.png" alt="logo">

    </a>
    Omar Olivares Urrutia
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ofou/ofou.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    olivares.cl
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
      <br>
      <small>A brief bio about myself</small>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Archive
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2025
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Categories
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/books/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Books
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/machine-learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Machine Learning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Projects
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Projects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../projects/graham/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Graham Essays
    
      <br>
      <small>in EPUB and Markdown, updated daily</small>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../projects/textube/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TexTube
    
      <br>
      <small>YouTube subtitles in ChatGPT fast</small>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-tinygrad" class="md-nav__link">
    <span class="md-ellipsis">
      Why Tinygrad?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-tensor" class="md-nav__link">
    <span class="md-ellipsis">
      The Tensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-devices" class="md-nav__link">
    <span class="md-ellipsis">
      The Devices
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lazy-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Lazy Evaluation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-uop" class="md-nav__link">
    <span class="md-ellipsis">
      The UOP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#realization" class="md-nav__link">
    <span class="md-ellipsis">
      Realization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operations-build-computation-graphs" class="md-nav__link">
    <span class="md-ellipsis">
      Operations build computation graphs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smart-deduplication" class="md-nav__link">
    <span class="md-ellipsis">
      Smart Deduplication
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automatic-differentiation" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Differentiation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automatic Differentiation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chain-rule" class="md-nav__link">
    <span class="md-ellipsis">
      Chain Rule
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graph-optimization-and-kernel-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Graph Optimization and Kernel Generation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Graph Optimization and Kernel Generation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generated-code" class="md-nav__link">
    <span class="md-ellipsis">
      Generated Code
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development-and-debugging-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Development and Debugging Tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Development and Debugging Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debug-flags" class="md-nav__link">
    <span class="md-ellipsis">
      Debug Flags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#color-coding-system" class="md-nav__link">
    <span class="md-ellipsis">
      Color Coding System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visual-graph-explorer" class="md-nav__link">
    <span class="md-ellipsis">
      Visual Graph Explorer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Topics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Topics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#low-level-uop-construction" class="md-nav__link">
    <span class="md-ellipsis">
      Low-Level UOP Construction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-matching-and-graph-rewriting" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern Matching and Graph Rewriting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-and-training" class="md-nav__link">
    <span class="md-ellipsis">
      Performance and Training
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance and Training">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#performance-expectations" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Expectations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-philosophy" class="md-nav__link">
    <span class="md-ellipsis">
      Training Philosophy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visual-graph-explorer_1" class="md-nav__link">
    <span class="md-ellipsis">
      Visual Graph Explorer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#glossary" class="md-nav__link">
    <span class="md-ellipsis">
      Glossary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../../" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
                  <span class="md-ellipsis">
                    Back to index
                  </span>
                </a>
              </div>
            </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    Metadata
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg>
                        <time datetime="2025-06-10 00:00:00+00:00" class="md-ellipsis">June 10, 2025</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg>
                          <span class="md-ellipsis">
                            in
                            
                              <a href="../../../../category/machine-learning/">Machine Learning</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg>
                          <span class="md-ellipsis">
                            
                              10 min read
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
            
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  



  
    <a href="https://github.com/ofou/ofou.github.io/edit/master/docs/blog/posts/tinygrad.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/ofou/ofou.github.io/raw/master/docs/blog/posts/tinygrad.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="introduction-to-tinygrad">Introduction to Tinygrad<a class="headerlink" href="#introduction-to-tinygrad" title="Permanent link">&para;</a></h1>
<p>Understanding Tinygrad can be hard, even Karpathy is a bit confused about it. This guide is my first attempt to navigate Tinygrad by synthesizing insights from official documentation and various livestreams.</p>
<!-- more -->

<iframe width="720" height="320" src="https://www.youtube.com/embed/QUry9dHC-bk" frameborder="0" allowfullscreen></iframe>

<h2 id="why-tinygrad">Why Tinygrad?<a class="headerlink" href="#why-tinygrad" title="Permanent link">&para;</a></h2>
<p>Tinygrad seems different from other mature frameworks such as <a href="https://pytorch.org/">PyTorch</a>, <a href="https://jax.readthedocs.io/en/latest/index.html">JAX</a>, and <a href="https://www.tensorflow.org/">TensorFlow</a> etc. But to me, what it seems appealing is that they want to democratize the petaflop as their core mission.</p>
<p>This is what I like about it:</p>
<ol>
<li>Fully open source (<em>even its hiring process, but that's another story</em>)</li>
<li>No dependencies</li>
<li>Multiple backends</li>
<li>And a very tiny codebase</li>
</ol>
<p>On the other hand, what I still don't like:</p>
<ol>
<li>Steep learning curve, and not noob friendly</li>
<li>Hard to read code</li>
<li>Not the best documentation, and some broken examples</li>
<li>It's not stable yet, but soon will be</li>
</ol>
<p>But let's start coding.</p>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<p>Tinygrad is designed to be hackable from the ground up. The recommended installation uses the editable <code>-e</code> flag from pip, allowing you to edit the source code and see changes right away.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/Tinygrad/Tinygrad.git
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nb">cd</span><span class="w"> </span>Tinygrad
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.
</span></code></pre></div>
<h2 id="the-tensor">The Tensor<a class="headerlink" href="#the-tensor" title="Permanent link">&para;</a></h2>
<p>Let's start with something familiar, thanks to Pytorch-like API, creating and manipulating tensors:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tinygrad</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tensor</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">t</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c1"># Basic operations work as expected</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">doubled</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">doubled</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>  <span class="c1"># [2, 4, 6, 8]</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="c1"># More complex operations</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="n">result</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>   <span class="c1"># [8, 10, 12, 14]</span>
</span></code></pre></div>
<p>This looks familiar if you've used PyTorch or NumPy. But Tinygrad is doing something fundamentally different under the hood, let's explore what makes it special.</p>
<h2 id="the-devices">The Devices<a class="headerlink" href="#the-devices" title="Permanent link">&para;</a></h2>
<p>Tinygrad's first key concept is the Device, where Tensors are stored and compute is executed. There are multiple devices supported, including CPU, CUDA, METAL, and more. For example, on my Apple Silicon macbook, the default device is METAL:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tinygrad</span><span class="w"> </span><span class="kn">import</span> <span class="n">Device</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">Device</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">)</span>  <span class="c1"># On Apple Silicon Mac: &quot;METAL&quot;</span>
</span></code></pre></div>
<p>Tinygrad auto-detects the best available device on your system and makes it the default. This could be METAL (Apple Silicon), CUDA (NVIDIA), CPU, or other supported backends. The device abstraction allows the same code to run across different hardware.</p>
<p>You can override the default device:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">Device</span><span class="o">.</span><span class="n">DEFAULT</span> <span class="o">=</span> <span class="s2">&quot;CPU&quot;</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">Device</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">)</span>  <span class="c1"># &quot;CPU&quot;</span>
</span></code></pre></div>
<h2 id="lazy-evaluation">Lazy Evaluation<a class="headerlink" href="#lazy-evaluation" title="Permanent link">&para;</a></h2>
<p>Here's where Tinygrad becomes interesting. Let's examine what we actually created:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tinygrad</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">dtypes</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">t</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="c1"># Examine the tensor properties</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="k">assert</span> <span class="n">t</span><span class="o">.</span><span class="n">device</span> <span class="o">==</span> <span class="n">Device</span><span class="o">.</span><span class="n">DEFAULT</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="k">assert</span> <span class="n">t</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">int</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="k">assert</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="c1"># &lt;Tensor &lt;UOp CPU (4,) int (&lt;Ops.COPY: 7&gt;, None)&gt; on CPU with grad None&gt;</span>
</span></code></pre></div>
<p><em>This Tensor has not been computed yet. Tinygrad is lazy - it builds a computational specification rather than immediately executing operations. The Tensor contains a chain of UOPs (micro-operations) that specify how to compute it when needed.</em></p>
<h2 id="the-uop">The UOP<a class="headerlink" href="#the-uop" title="Permanent link">&para;</a></h2>
<p>UOPs (micro-operations) are the core specification language in Tinygrad. They are immutable and form a <a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph">DAG</a> (Directed Acyclic Graph). Each UOP has an operation type, dtype, arguments, and source dependencies.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">uop</span><span class="p">)</span>
</span></code></pre></div>
<p>You'll see something like:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">UOp</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">COPY</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="p">(</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>  <span class="n">UOp</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">BUFFER</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="p">(</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="n">UOp</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">UNIQUE</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">void</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="p">()),</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    <span class="n">UOp</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">DEVICE</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">void</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="s1">&#39;PYTHON&#39;</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="p">()),)),</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>  <span class="n">UOp</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">DEVICE</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">void</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="s1">&#39;CPU&#39;</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="p">()),))</span>
</span></code></pre></div>
<p>This UOP tree specifies a COPY operation from a BUFFER on the PYTHON device (where our Python list <code>[1,2,3,4]</code> lives) to the CPU device. The UNIQUE identifier ensures unambiguous reference to this specific buffer.</p>
<pre class="mermaid"><code>flowchart LR
    A["COPY&lt;br/&gt;dtypes.int&lt;br/&gt;arg=None"]
    B["BUFFER&lt;br/&gt;dtypes.int&lt;br/&gt;arg=4"]
    C["UNIQUE&lt;br/&gt;dtypes.void&lt;br/&gt;arg=0"]
    D["DEVICE&lt;br/&gt;dtypes.void&lt;br/&gt;arg='PYTHON'"]
    E["DEVICE&lt;br/&gt;dtypes.void&lt;br/&gt;arg='CPU'"]

    A --&gt; B
    A --&gt; E
    B --&gt; C
    B --&gt; D</code></pre>
<h2 id="realization">Realization<a class="headerlink" href="#realization" title="Permanent link">&para;</a></h2>
<p>To execute the computational specification, we use the <code>realize()</code> method:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">t</span><span class="o">.</span><span class="n">realize</span><span class="p">()</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">uop</span><span class="p">)</span>
</span></code></pre></div>
<p>After realization, the UOP changes fundamentally:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">UOp</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">BUFFER</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="p">(</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>  <span class="n">UOp</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">UNIQUE</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">void</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="p">()),</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>  <span class="n">UOp</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">DEVICE</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">void</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="s1">&#39;CPU&#39;</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="p">()),))</span>
</span></code></pre></div>
<pre class="mermaid"><code>flowchart LR
    A["BUFFER&lt;br/&gt;dtypes.int&lt;br/&gt;arg=4"]
    B["UNIQUE&lt;br/&gt;dtypes.void&lt;br/&gt;arg=1"]
    C["DEVICE&lt;br/&gt;dtypes.void&lt;br/&gt;arg='CPU'"]

    A --&gt; B
    A --&gt; C</code></pre>
<p>The COPY operation has been replaced by a simple BUFFER reference. The UNIQUE identifier changed from <code>arg=0</code> to <code>arg=1</code>, indicating the data now exists as a new computational artifact on the target device.</p>
<h2 id="operations-build-computation-graphs">Operations build computation graphs<a class="headerlink" href="#operations-build-computation-graphs" title="Permanent link">&para;</a></h2>
<p>Let's see how operations create more complex graphs:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">t_times_2</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">t_times_2</span><span class="o">.</span><span class="n">uop</span><span class="p">)</span>
</span></code></pre></div>
<p>This creates a UOP tree with a MUL operation. What appears as simple scalar multiplication becomes an explicit broadcasting specification:</p>
<pre class="mermaid"><code>flowchart LR
    A["MUL&lt;br/&gt;dtypes.int&lt;br/&gt;arg=None"]
    B["BUFFER&lt;br/&gt;dtypes.int&lt;br/&gt;arg=4"]
    C["UNIQUE&lt;br/&gt;dtypes.void&lt;br/&gt;arg=1"]
    D["DEVICE (x2)&lt;br/&gt;dtypes.void&lt;br/&gt;arg='CPU'"]
    E["EXPAND&lt;br/&gt;dtypes.int&lt;br/&gt;arg=(4,)"]
    F["RESHAPE&lt;br/&gt;dtypes.int&lt;br/&gt;arg=(1,)"]
    G["CONST&lt;br/&gt;dtypes.int&lt;br/&gt;arg=2"]
    H["VIEW&lt;br/&gt;dtypes.void&lt;br/&gt;arg=ShapeTracker"]

    A --&gt; B
    A --&gt; E
    B --&gt; C
    B --&gt; D
    E --&gt; F
    F --&gt; G
    G --&gt; H
    H --&gt; D</code></pre>
<p><strong>Understanding Broadcasting</strong>: The scalar <code>2</code> is transformed through RESHAPE and EXPAND operations to match our Tensor's shape. This makes the computational intent explicit and optimizable.</p>
<p>We can verify the result:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">assert</span> <span class="n">t_times_2</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
</span></code></pre></div>
<h2 id="smart-deduplication">Smart Deduplication<a class="headerlink" href="#smart-deduplication" title="Permanent link">&para;</a></h2>
<p>UOPs are both immutable and globally unique, leading to elegant computational deduplication:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">A</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="mi">4</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">B</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="mi">4</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="c1"># Different Python objects</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="k">assert</span> <span class="n">A</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">B</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="c1"># Same computational specification</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="k">assert</span> <span class="n">A</span><span class="o">.</span><span class="n">uop</span> <span class="ow">is</span> <span class="n">B</span><span class="o">.</span><span class="n">uop</span>
</span></code></pre></div>
<p>When we realize one Tensor, both benefit from the shared computation:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">A</span><span class="o">.</span><span class="n">realize</span><span class="p">()</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c1"># Both tensors now point to the same realized buffer</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="k">assert</span> <span class="n">A</span><span class="o">.</span><span class="n">uop</span> <span class="ow">is</span> <span class="n">B</span><span class="o">.</span><span class="n">uop</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>  <span class="c1"># [4, 8, 12, 16] - no computation needed</span>
</span></code></pre></div>
<h2 id="automatic-differentiation">Automatic Differentiation<a class="headerlink" href="#automatic-differentiation" title="Permanent link">&para;</a></h2>
<p>Tinygrad includes automatic differentiation that operates on the same UOP principles. Let's see gradients in action:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="n">loss</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">item</span><span class="p">())</span> <span class="c1"># 2.0</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">item</span><span class="p">())</span> <span class="c1"># 4 + 6 + 1 = 11</span>
</span></code></pre></div>
<p>For the function <span class="arithmatex">\(y = x^2 + 3x + 1\)</span>, the derivative is:</p>
<div class="arithmatex">\[\frac{dy}{dx} = 2x + 3\]</div>
<p>At our input value <span class="arithmatex">\(x = 2\)</span>:</p>
<div class="arithmatex">\[\frac{dy}{dx}\bigg|_{x=2} = 2(2) + 3 = 7\]</div>
<p>Now let's compute the gradient using Tinygrad's automatic differentiation:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">grad</span><span class="p">,</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">grad</span><span class="o">.</span><span class="n">item</span><span class="p">())</span> <span class="c1"># 7.0</span>
</span></code></pre></div>
<h3 id="chain-rule">Chain Rule<a class="headerlink" href="#chain-rule" title="Permanent link">&para;</a></h3>
<p>Tinygrad automatically applies the chain rule:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">x</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="n">loss</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">item</span><span class="p">())</span> <span class="c1"># 2.0</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">item</span><span class="p">())</span> <span class="c1"># log(2^2 + 1) = log(5) ≈ 1.6094378232955933</span>
</span></code></pre></div>
<p>For the composite function <span class="arithmatex">\(z = \log(x^2 + 1)\)</span>, we need to apply the chain rule:</p>
<ol>
<li>
<p>Let <span class="arithmatex">\(z = \log(x^{2}+1)\)</span>.<br />
   Set <span class="arithmatex">\(g(x)=x^{2}+1\)</span>. Then <span class="arithmatex">\(z = \log(g(x))\)</span>.</p>
</li>
<li>
<p>Apply the chain rule:<br />
<span class="arithmatex">\(\frac{dz}{dx} = \frac{1}{g(x)} \cdot g'(x) = \frac{1}{x^2+1} \cdot 2x = \frac{2x}{x^2+1}\)</span></p>
</li>
<li>
<p>Evaluate at <span class="arithmatex">\(x=2\)</span>:<br />
<span class="arithmatex">\(\frac{dz}{dx}|_{x=2} = \frac{2 \cdot 2}{2^2+1} = \frac{4}{5} = 0.8\)</span></p>
</li>
</ol>
<p>Tinygrad handles all the chain rule complexity automatically:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">grad</span><span class="p">,</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">grad</span><span class="o">.</span><span class="n">item</span><span class="p">())</span> <span class="c1"># 0.8</span>
</span></code></pre></div>
<h2 id="graph-optimization-and-kernel-generation">Graph Optimization and Kernel Generation<a class="headerlink" href="#graph-optimization-and-kernel-generation" title="Permanent link">&para;</a></h2>
<p>Tinygrad's power lies in its graph rewrite system. Let's see optimization in action:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">t</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">t_plus_3_plus_4</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">t_plus_3_plus_4</span><span class="o">.</span><span class="n">uop</span><span class="p">)</span>  <span class="c1"># Shows addition of 3 and 4 separately</span>
</span></code></pre></div>
<pre class="mermaid"><code>flowchart LR
    A["ADD (outer)&lt;br/&gt;dtypes.int&lt;br/&gt;arg=None"]
    B["ADD (inner)&lt;br/&gt;dtypes.int&lt;br/&gt;arg=None"]
    C["COPY&lt;br/&gt;dtypes.int&lt;br/&gt;arg=None"]
    D["BUFFER&lt;br/&gt;dtypes.int&lt;br/&gt;arg=4"]
    E["UNIQUE&lt;br/&gt;dtypes.void&lt;br/&gt;arg=8"]
    F["DEVICE&lt;br/&gt;dtypes.void&lt;br/&gt;arg='PYTHON'"]
    G["DEVICE (x5)&lt;br/&gt;dtypes.void&lt;br/&gt;arg='CPU'"]
    H["EXPAND&lt;br/&gt;dtypes.int&lt;br/&gt;arg=(4,)"]
    I["RESHAPE&lt;br/&gt;dtypes.int&lt;br/&gt;arg=(1,)"]
    J["CONST&lt;br/&gt;dtypes.int&lt;br/&gt;arg=3"]
    K["VIEW (x9)&lt;br/&gt;dtypes.void&lt;br/&gt;arg=ShapeTracker"]
    L["EXPAND&lt;br/&gt;dtypes.int&lt;br/&gt;arg=(4,)"]
    M["RESHAPE&lt;br/&gt;dtypes.int&lt;br/&gt;arg=(1,)"]
    N["CONST&lt;br/&gt;dtypes.int&lt;br/&gt;arg=4"]

    A --&gt; B
    A --&gt; L
    B --&gt; C
    B --&gt; H
    C --&gt; D
    C --&gt; G
    D --&gt; E
    D --&gt; F
    H --&gt; I
    I --&gt; J
    J --&gt; K
    K --&gt; G
    L --&gt; M
    M --&gt; N
    N --&gt; K</code></pre>
<p>The initial UOP tree shows two separate ADD operations. But when we prepare for kernel generation:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">t_plus_3_plus_4</span><span class="o">.</span><span class="n">kernelize</span><span class="p">()</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">t_plus_3_plus_4</span><span class="o">.</span><span class="n">uop</span><span class="p">)</span>
</span></code></pre></div>
<p>The graph rewrite engine has optimized this to add 7 directly, demonstrating constant folding:</p>
<pre class="mermaid"><code>flowchart LR
    A["ASSIGN (outer)&lt;br/&gt;dtypes.int&lt;br/&gt;arg=None"]
    B["BUFFER (x0)&lt;br/&gt;dtypes.int&lt;br/&gt;arg=4"]
    C["UNIQUE&lt;br/&gt;dtypes.void&lt;br/&gt;arg=10"]
    D["DEVICE (x2)&lt;br/&gt;dtypes.void&lt;br/&gt;arg='CPU'"]
    E["KERNEL 12&lt;br/&gt;dtypes.void&lt;br/&gt;arg=&amp;lt;SINK __add__&amp;gt;"]
    F["ASSIGN (inner)&lt;br/&gt;dtypes.int&lt;br/&gt;arg=None"]
    G["BUFFER (x5)&lt;br/&gt;dtypes.int&lt;br/&gt;arg=4"]
    H["UNIQUE&lt;br/&gt;dtypes.void&lt;br/&gt;arg=9"]
    I["KERNEL 5&lt;br/&gt;dtypes.void&lt;br/&gt;arg=&amp;lt;COPY&amp;gt;"]
    J["BUFFER&lt;br/&gt;dtypes.int&lt;br/&gt;arg=4"]
    K["UNIQUE&lt;br/&gt;dtypes.void&lt;br/&gt;arg=8"]
    L["DEVICE&lt;br/&gt;dtypes.void&lt;br/&gt;arg='PYTHON'"]

    A --&gt; B
    A --&gt; E
    B --&gt; C
    B --&gt; D
    E --&gt; B
    E --&gt; F
    F --&gt; G
    F --&gt; I
    G --&gt; H
    G --&gt; D
    I --&gt; G
    I --&gt; J
    J --&gt; K
    J --&gt; L</code></pre>
<p>We can extract and examine the kernel AST:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">kernel_ast</span> <span class="o">=</span> <span class="n">t_plus_3_plus_4</span><span class="o">.</span><span class="n">uop</span><span class="o">.</span><span class="n">src</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">arg</span><span class="o">.</span><span class="n">ast</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tinygrad.codegen</span><span class="w"> </span><span class="kn">import</span> <span class="n">full_rewrite_to_sink</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="n">rewritten_ast</span> <span class="o">=</span> <span class="n">full_rewrite_to_sink</span><span class="p">(</span><span class="n">kernel_ast</span><span class="p">)</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">rewritten_ast</span><span class="p">)</span>
</span></code></pre></div>
<pre class="mermaid"><code>flowchart LR
    A["SINK&lt;br/&gt;dtypes.void&lt;br/&gt;arg=None"]
    B["STORE&lt;br/&gt;dtypes.void&lt;br/&gt;arg=None"]
    C["INDEX (output)&lt;br/&gt;dtypes.int.ptr(4)&lt;br/&gt;arg=None"]
    D["DEFINE_GLOBAL&lt;br/&gt;dtypes.int.ptr(4)&lt;br/&gt;arg=0"]
    E["SPECIAL (x3)&lt;br/&gt;dtypes.int&lt;br/&gt;arg=('gidx0', 4)"]
    F["ADD&lt;br/&gt;dtypes.int&lt;br/&gt;arg=None"]
    G["LOAD&lt;br/&gt;dtypes.int&lt;br/&gt;arg=None"]
    H["INDEX (input)&lt;br/&gt;dtypes.int.ptr(4)&lt;br/&gt;arg=None"]
    I["DEFINE_GLOBAL&lt;br/&gt;dtypes.int.ptr(4)&lt;br/&gt;arg=1"]
    J["CONST&lt;br/&gt;dtypes.int&lt;br/&gt;arg=7"]

    A --&gt; B
    B --&gt; C
    B --&gt; F
    C --&gt; D
    C --&gt; E
    F --&gt; G
    F --&gt; J
    G --&gt; H
    H --&gt; I
    H --&gt; E</code></pre>
<p>This shows the final optimized computation graph that will be compiled to device code.</p>
<h3 id="generated-code">Generated Code<a class="headerlink" href="#generated-code" title="Permanent link">&para;</a></h3>
<p>With <code>DEBUG=4</code>, we can see the actual generated kernel code:</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">E_4n2</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="kr">restrict</span><span class="w"> </span><span class="n">data0</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="kr">restrict</span><span class="w"> </span><span class="n">data1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">val0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">data1</span><span class="o">+</span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">val1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">data1</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">val2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">data1</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">val3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">data1</span><span class="o">+</span><span class="mi">3</span><span class="p">);</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">data0</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">val0</span><span class="o">+</span><span class="mi">7</span><span class="p">);</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">data0</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">val1</span><span class="o">+</span><span class="mi">7</span><span class="p">);</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">data0</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">val2</span><span class="o">+</span><span class="mi">7</span><span class="p">);</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">data0</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">val3</span><span class="o">+</span><span class="mi">7</span><span class="p">);</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="p">}</span>
</span></code></pre></div>
<p>When running with <code>DEBUG=2</code>, the <code>4</code> appears in yellow to indicate it's been upcasted. Running with <code>NOOPT=1</code> will show the unoptimized code with a loop:</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">E_4n2</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="kr">restrict</span><span class="w"> </span><span class="n">data0</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="kr">restrict</span><span class="w"> </span><span class="n">data1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">ridx0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">ridx0</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">ridx0</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">val0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">data1</span><span class="o">+</span><span class="n">ridx0</span><span class="p">);</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="n">data0</span><span class="o">+</span><span class="n">ridx0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">val0</span><span class="o">+</span><span class="mi">7</span><span class="p">);</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="p">}</span>
</span></code></pre></div>
<h2 id="development-and-debugging-tools">Development and Debugging Tools<a class="headerlink" href="#development-and-debugging-tools" title="Permanent link">&para;</a></h2>
<h3 id="debug-flags">Debug Flags<a class="headerlink" href="#debug-flags" title="Permanent link">&para;</a></h3>
<p>Tinygrad provides extensive debugging capabilities:</p>
<ul>
<li><code>DEBUG=2</code> - Shows data movement and kernel execution</li>
<li><code>DEBUG=4</code> - Shows generated kernel code</li>
<li><code>VIZ=1</code> - Launches web-based graph rewrite explorer</li>
<li><code>NOOPT=1</code> - Disables optimizations for debugging</li>
</ul>
<h3 id="color-coding-system">Color Coding System<a class="headerlink" href="#color-coding-system" title="Permanent link">&para;</a></h3>
<p>Tinygrad uses a color system in debug output to indicate optimization states:</p>
<ul>
<li><strong>Blue</strong>: Global operations (e.g. <code>ADD</code>)</li>
<li><strong>Light Blue</strong>: Local operations (e.g. <code>COPY</code>)</li>
<li><strong>Red</strong>: Reduce operations (e.g. <code>SUM</code>)</li>
<li><strong>Yellow</strong>: Upcasted operations (e.g. <code>EXPAND</code>)</li>
<li><strong>Purple</strong>: Unrolled operations (e.g. <code>UNROLL</code>)</li>
<li><strong>Green</strong>: Group operations (e.g. <code>GROUP</code>)</li>
</ul>
<h3 id="visual-graph-explorer">Visual Graph Explorer<a class="headerlink" href="#visual-graph-explorer" title="Permanent link">&para;</a></h3>
<p>You can explore Tinygrad's graph rewriting visually:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nv">VIZ</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>python<span class="w"> </span>ramp.py
</span></code></pre></div>
<p>This launches a web-based graph rewrite explorer where you can see UOP transformations in real-time.</p>
<h2 id="advanced-topics">Advanced Topics<a class="headerlink" href="#advanced-topics" title="Permanent link">&para;</a></h2>
<h3 id="low-level-uop-construction">Low-Level UOP Construction<a class="headerlink" href="#low-level-uop-construction" title="Permanent link">&para;</a></h3>
<p>For complete understanding, you can construct UOPs directly:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tinygrad</span><span class="w"> </span><span class="kn">import</span> <span class="n">dtypes</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tinygrad.uop</span><span class="w"> </span><span class="kn">import</span> <span class="n">UOp</span><span class="p">,</span> <span class="n">Ops</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="c1"># Create constant UOPs</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="n">a</span> <span class="o">=</span> <span class="n">UOp</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">CONST</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="n">b</span> <span class="o">=</span> <span class="n">UOp</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">CONST</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="c1"># Global uniqueness: same specifications = same object</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="k">assert</span> <span class="n">a</span> <span class="ow">is</span> <span class="n">b</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="c1"># Construct computation</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="n">a_plus_b</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">a_plus_b</span><span class="p">)</span>
</span></code></pre></div>
<p>This results in a UOP that adds two constants:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">UOp</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">ADD</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="p">(</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>  <span class="n">x0</span><span class="o">:=</span><span class="n">UOp</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">CONST</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">int</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="p">()),</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>   <span class="n">x0</span><span class="p">,))</span>
</span></code></pre></div>
<h3 id="pattern-matching-and-graph-rewriting">Pattern Matching and Graph Rewriting<a class="headerlink" href="#pattern-matching-and-graph-rewriting" title="Permanent link">&para;</a></h3>
<p>Tinygrad's graph rewrite engine uses pattern matching for optimizations:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tinygrad.uop.ops</span><span class="w"> </span><span class="kn">import</span> <span class="n">graph_rewrite</span><span class="p">,</span> <span class="n">UPat</span><span class="p">,</span> <span class="n">PatternMatcher</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tinygrad.uop</span><span class="w"> </span><span class="kn">import</span> <span class="n">UOp</span><span class="p">,</span> <span class="n">Ops</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="c1"># Define a constant folding pattern</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="n">simple_pm</span> <span class="o">=</span> <span class="n">PatternMatcher</span><span class="p">([</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>  <span class="p">(</span><span class="n">UPat</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">ADD</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="p">(</span><span class="n">UPat</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">CONST</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;c1&quot;</span><span class="p">),</span> <span class="n">UPat</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">CONST</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;c2&quot;</span><span class="p">))),</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>   <span class="k">lambda</span> <span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">:</span> <span class="n">UOp</span><span class="p">(</span><span class="n">Ops</span><span class="o">.</span><span class="n">CONST</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">c1</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="n">c1</span><span class="o">.</span><span class="n">arg</span><span class="o">+</span><span class="n">c2</span><span class="o">.</span><span class="n">arg</span><span class="p">)),</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="p">])</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="c1"># Apply the pattern</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="n">a_plus_b_simplified</span> <span class="o">=</span> <span class="n">graph_rewrite</span><span class="p">(</span><span class="n">a_plus_b</span><span class="p">,</span> <span class="n">simple_pm</span><span class="p">)</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="nb">print</span><span class="p">(</span><span class="n">a_plus_b_simplified</span><span class="p">)</span>  <span class="c1"># UOp(Ops.CONST, dtypes.int, arg=4, src=())</span>
</span></code></pre></div>
<p>Syntactic sugar makes patterns more readable:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="n">simpler_pm</span> <span class="o">=</span> <span class="n">PatternMatcher</span><span class="p">([</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>  <span class="p">(</span><span class="n">UPat</span><span class="o">.</span><span class="n">cvar</span><span class="p">(</span><span class="s2">&quot;c1&quot;</span><span class="p">)</span><span class="o">+</span><span class="n">UPat</span><span class="o">.</span><span class="n">cvar</span><span class="p">(</span><span class="s2">&quot;c2&quot;</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">:</span> <span class="n">c1</span><span class="o">.</span><span class="n">const_like</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">arg</span><span class="o">+</span><span class="n">c2</span><span class="o">.</span><span class="n">arg</span><span class="p">))</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="p">])</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="k">assert</span> <span class="n">graph_rewrite</span><span class="p">(</span><span class="n">a_plus_b</span><span class="p">,</span> <span class="n">simple_pm</span><span class="p">)</span> <span class="ow">is</span> <span class="n">graph_rewrite</span><span class="p">(</span><span class="n">a_plus_b</span><span class="p">,</span> <span class="n">simpler_pm</span><span class="p">)</span>
</span></code></pre></div>
<h2 id="performance-and-training">Performance and Training<a class="headerlink" href="#performance-and-training" title="Permanent link">&para;</a></h2>
<h3 id="performance-expectations">Performance Expectations<a class="headerlink" href="#performance-expectations" title="Permanent link">&para;</a></h3>
<p>You should expect competitive performance today. With <code>BEAM=2</code> optimization, Tinygrad often outperforms PyTorch on:</p>
<ul>
<li>Unoptimized workloads</li>
<li>AMD hardware</li>
<li>Training scenarios (20% faster than PyTorch on AMD in HLBC implementation)</li>
</ul>
<h3 id="training-philosophy">Training Philosophy<a class="headerlink" href="#training-philosophy" title="Permanent link">&para;</a></h3>
<p>Tinygrad avoids the <code>trainer.fit()</code> abstraction. If you examine <code>examples/beautiful_mnist.py</code>, you'll find a complete MNIST trainer that contains everything you need and nothing you don't.</p>
<h3 id="visual-graph-explorer_1">Visual Graph Explorer<a class="headerlink" href="#visual-graph-explorer_1" title="Permanent link">&para;</a></h3>
<p>You can explore Tinygrad's graph rewriting visually:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nv">VIZ</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>python<span class="w"> </span>ramp.py
</span></code></pre></div>
<p>Environment variables like <code>DEBUG=2</code> or <code>CPU=1</code> are set in bash like: <code>DEBUG=2 CPU=1 python docs/ramp.py</code>.</p>
<p>This launches a web-based graph rewrite explorer where you can see UOP transformations in real-time.</p>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>You now understand Tinygrad's core concepts: how UOPs transform through graph rewrites to create optimized computational kernels. The beauty lies not in each line being simple, but in the whole system being maintainable by small groups of smart engineers, and you can be one of them.</p>
<h2 id="glossary">Glossary<a class="headerlink" href="#glossary" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Term</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>Device</td>
<td>Hardware backend where tensors live and kernels run (e.g. <code>CPU</code>, <code>CUDA</code>, <code>METAL</code>).</td>
</tr>
<tr>
<td>Lazy / Realize</td>
<td>Tinygrad records operations lazily; <code>realize()</code> forces execution.</td>
</tr>
<tr>
<td>UOp</td>
<td>Immutable micro-operation node in the computation graph.</td>
</tr>
<tr>
<td>DAG</td>
<td>Directed acyclic graph composed of UOps.</td>
</tr>
<tr>
<td>Kernelize</td>
<td>Transformation that groups UOps into executable kernels.</td>
</tr>
<tr>
<td>ShapeTracker</td>
<td>Tracks tensor views/shapes without copying data.</td>
</tr>
<tr>
<td>Upcast</td>
<td>Optimisation that widens ops to work on multiple elements at once.</td>
</tr>
</tbody>
</table>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="July 8, 2025 15:58:42 -04"><span class="timeago" datetime="2025-07-08T15:58:42-04:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="July 8, 2025 15:58:42 -04">2025-07-08</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="July 8, 2025 15:54:14 -04"><span class="timeago" datetime="2025-07-08T15:54:14-04:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="July 8, 2025 15:54:14 -04">2025-07-08</span>
  </span>

    
    
    
  </aside>


  


  
    
  



  <h2 id="__comments">Comments</h2>
  <!-- Giscus Comments Section -->
  <script src="https://giscus.app/client.js"
        data-repo="ofou/ofou.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkzNzQxNDAxMDM="
        data-category="General"
        data-category-id="DIC_kwDOFkzsx84CtY2c"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
    </script>

  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate"
        ? "transparent_dark"
        : "light"

      // Instruct Giscus to set theme
      giscus.setAttribute("data-theme", theme)
    }

    // Register event handlers after document loaded
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      if (ref) {
        ref.addEventListener("change", function() {
          var palette = __md_get("__palette")
          if (palette && typeof palette.color === "object") {
            var theme = palette.color.scheme === "slate"
              ? "transparent_dark"
              : "light"

            // Instruct Giscus to change theme
            var frame = document.querySelector(".giscus-frame")
            if (frame) {
              frame.contentWindow.postMessage(
                { giscus: { setConfig: { theme } } },
                "https://giscus.app"
              )
            }
          }
        })
      }
    })
  </script>
 
      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../../01/01/things-you-should-be-reading-about-ai-in-2025/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Things you should be reading about AI in 2025">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Things you should be reading about AI in 2025
              </div>
            </div>
          </a>
        
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copy, share and modify freely ♡
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/ofou" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/omarnomad" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/ofou/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/@omarnomad" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.instagram.com/omarnomad/" target="_blank" rel="noopener" title="www.instagram.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M224.3 141a115 115 0 1 0-.6 230 115 115 0 1 0 .6-230m-.6 40.4a74.6 74.6 0 1 1 .6 149.2 74.6 74.6 0 1 1-.6-149.2m93.4-45.1a26.8 26.8 0 1 1 53.6 0 26.8 26.8 0 1 1-53.6 0m129.7 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8M399 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://calendar.app.google/kcbfemxAYBoNPXbS8" target="_blank" rel="noopener" title="calendar.app.google" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M128 0c17.7 0 32 14.3 32 32v32h128V32c0-17.7 14.3-32 32-32s32 14.3 32 32v32h32c35.3 0 64 28.7 64 64v288c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128c0-35.3 28.7-64 64-64h32V32c0-17.7 14.3-32 32-32M64 240v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16H80c-8.8 0-16 7.2-16 16m128 0v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16m144-16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zM64 368v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16H80c-8.8 0-16 7.2-16 16m144-16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm112 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../../../../js/timeago.min.js"></script>
      
        <script src="../../../../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../../../../static/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>